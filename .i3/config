# if $scratchclass is changed, it needs to be changed in scratchpad.sh too
set $scratchclass scratchpad-terminal
set $floatingclass floating-terminal

# scripts
set $bookmarkscript ~/.i3/rofibookmarks.sh
set $centerscript ~/.i3/center_cursor.sh
set $comptonscript ~/.i3/compton.sh
set $entiresplitscript ~/.i3/splitentire.sh
set $exitscript ~/.i3/exit.sh
set $initscript ~/.i3/init.sh
set $manscript ~/.i3/rofiman.sh
set $mousescript ~/.i3/mouse_action.sh
set $newworkspacescript ~/.i3/new_workspace.sh
set $openscript ~/.i3/rofilocate.sh
set $pulsescript ~/.i3/pulse.sh
set $renameworkspacescript ~/.i3/rename_workspace.sh
set $rofiinteractivescript ~/.i3/rofiinteractive.sh
set $rofipythonscript ~/.i3/rofipython.sh
set $scratchscript ~/.i3/scratchpad.sh
set $scrotscript ~/.i3/screenshot.sh
set $surfrawscript ~/.i3/rofisurfraw.sh
set $wallpaperscript ~/.i3/set_wallpaper.sh
set $workspacescript ~/.i3/workspace.sh

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below. ISO 10646 = Unicode
font pango:Inconsolata 12
# font pango:Inconsolata 13px

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec urxvtc

# start a floating terminal with tmux
bindsym $mod+Shift+Return exec "urxvt -name $scratchclass -e tmux new-session -As0"

# start a floating terminal with zsh
bindsym $mod+Ctrl+Return exec "urxvt -name $floatingclass"

# kill focused window
bindsym $mod+Shift+q kill

# rofi
bindsym $mod+space exec --no-startup-id rofi -show drun
bindsym $mod+Mod1+space exec --no-startup-id rofi -show run
bindsym $mod+g exec --no-startup-id rofi -show window
bindsym $mod+Shift+g exec --no-startup-id rofi -show windowcd
bindsym $mod+Ctrl+g exec --no-startup-id rofi -show combi

# start a websearch
bindsym $mod+q exec --no-startup-id $surfrawscript search

# screenshots
bindsym Print exec --no-startup-id $scrotscript --action=whole
# does not work without the sleep command; fails to grab pointer
bindsym Ctrl+Print exec --no-startup-id "sleep 0.2; $scrotscript --action=select"
bindsym Shift+Print exec --no-startup-id $scrotscript --action=window

# screenshot mode
set $mode_scrot "scrot: (w)indow, (e)verything, (s)election; shift -> 3s delay; ctrl -> copy to clipboard (nosave)"
mode $mode_scrot {
    bindsym w exec --no-startup-id $scrotscript --action=window --show, mode "default"
    bindsym e exec --no-startup-id $scrotscript --action=whole --show, mode "default"
    bindsym s exec --no-startup-id "sleep 0.2; $scrotscript --action=select --show", mode "default"
    bindsym Shift+w exec --no-startup-id $scrotscript --action=window --show --delay=3, mode "default"
    bindsym Shift+e exec --no-startup-id $scrotscript --action=whole --show --delay=3, mode "default"
    bindsym Shift+s exec --no-startup-id "sleep 3; $scrotscript --action=select --show", mode "default"
    bindsym Ctrl+w exec --no-startup-id $scrotscript --action=window --clip --no-save --show, mode "default"
    bindsym Ctrl+e exec --no-startup-id $scrotscript --action=whole --clip --no-save --show, mode "default"
    bindsym Ctrl+s exec --no-startup-id "sleep 0.2; $scrotscript --action=select --clip --no-save --show", mode "default"
    bindsym Ctrl+Shift+w exec --no-startup-id $scrotscript --action=window --clip --delay=3 --no-save, mode "default"
    bindsym Ctrl+Shift+e exec --no-startup-id $scrotscript --action=whole --clip --delay=3 --no-save, mode "default"
    bindsym Ctrl+Shift+s exec --no-startup-id "sleep 3; $scrotscript --action=select --clip --no-save", mode "default"
    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_open "open: (x)dg, (t)erminal, (s)urfraw, (b)ookmark, (m)anpage, (c/C)alculator, (p/P)ython, (B)ash"
mode $mode_open {
    bindsym x exec --no-startup-id $openscript xdg, mode "default"
    bindsym t exec --no-startup-id $openscript term, mode "default"
    bindsym s exec --no-startup-id $surfrawscript both, mode "default"
    bindsym b exec --no-startup-id $bookmarkscript, mode "default"
    bindsym m exec --no-startup-id $manscript, mode "default"
    bindsym c exec --no-startup-id rofi -no-sidebar-mode -show qalc -modi "qalc:qalc +u8", mode "default"
    bindsym Shift+c exec --no-startup-id $rofiinteractivescript qalc, mode "default"
    bindsym p exec --no-startup-id rofi -no-sidebar-mode -show py -modi "py:$rofipythonscript", mode "default"
    bindsym Shift+p exec --no-startup-id $rofiinteractivescript python, mode "default"
    bindsym Shift+B exec --no-startup-id $rofiinteractivescript bash, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $mod+o mode $mode_open

set $mode_focus "FOCUS"
mode $mode_focus {
    bindsym $mod+e fullscreen disable, bar mode dock, mode "default"
    # focus
    bindsym $mod+h focus left
    bindsym $mod+j focus down
    bindsym $mod+k focus up
    bindsym $mod+l focus right
    # switch workspace
    bindsym $mod+Tab workspace back_and_forth
}

set $mode_compton "compton: (i) invert, (k) kill, (s) start"
mode $mode_compton {
    bindsym i exec --no-startup-id $comptonscript invert, mode "default"
    bindsym k exec --no-startup-id $comptonscript kill, mode "default"
    bindsym s exec --no-startup-id $comptonscript start, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_extended "extended: (f)ocus, (c)ompton, (s)crot"
mode $mode_extended {
    bindsym f fullscreen enable, bar mode invisible, mode $mode_focus
    bindsym c mode $mode_compton
    bindsym s mode $mode_scrot
    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $mod+x mode $mode_extended

set $mode_mark "mark"
mode $mode_mark {
    bindsym a mark --toggle a, mode "default"
    bindsym b mark --toggle b, mode "default"
    bindsym c mark --toggle c, mode "default"
    bindsym d mark --toggle d, mode "default"
    bindsym e mark --toggle e, mode "default"
    bindsym f mark --toggle f, mode "default"
    bindsym g mark --toggle g, mode "default"
    bindsym h mark --toggle h, mode "default"
    bindsym i mark --toggle i, mode "default"
    bindsym j mark --toggle j, mode "default"
    bindsym k mark --toggle k, mode "default"
    bindsym l mark --toggle l, mode "default"
    bindsym m mark --toggle m, mode "default"
    bindsym n mark --toggle n, mode "default"
    bindsym o mark --toggle o, mode "default"
    bindsym p mark --toggle p, mode "default"
    bindsym q mark --toggle q, mode "default"
    bindsym r mark --toggle r, mode "default"
    bindsym s mark --toggle s, mode "default"
    bindsym t mark --toggle t, mode "default"
    bindsym u mark --toggle u, mode "default"
    bindsym v mark --toggle v, mode "default"
    bindsym w mark --toggle w, mode "default"
    bindsym x mark --toggle x, mode "default"
    bindsym y mark --toggle y, mode "default"
    bindsym z mark --toggle z, mode "default"
    # back to normal: Enter or Escape
    bindsym Return unmark, mode "default"
    bindsym Escape unmark, mode "default"
}

bindsym $mod+Shift+y mode $mode_mark

set $mode_goto_mark "go to mark / move to mark"
mode $mode_goto_mark {
    bindsym a [con_mark="a"] focus, mode "default"
    bindsym b [con_mark="b"] focus, mode "default"
    bindsym c [con_mark="c"] focus, mode "default"
    bindsym d [con_mark="d"] focus, mode "default"
    bindsym e [con_mark="e"] focus, mode "default"
    bindsym f [con_mark="f"] focus, mode "default"
    bindsym g [con_mark="g"] focus, mode "default"
    bindsym h [con_mark="h"] focus, mode "default"
    bindsym i [con_mark="i"] focus, mode "default"
    bindsym j [con_mark="j"] focus, mode "default"
    bindsym k [con_mark="k"] focus, mode "default"
    bindsym l [con_mark="l"] focus, mode "default"
    bindsym m [con_mark="m"] focus, mode "default"
    bindsym n [con_mark="n"] focus, mode "default"
    bindsym o [con_mark="o"] focus, mode "default"
    bindsym p [con_mark="p"] focus, mode "default"
    bindsym q [con_mark="q"] focus, mode "default"
    bindsym r [con_mark="r"] focus, mode "default"
    bindsym s [con_mark="s"] focus, mode "default"
    bindsym t [con_mark="t"] focus, mode "default"
    bindsym u [con_mark="u"] focus, mode "default"
    bindsym v [con_mark="v"] focus, mode "default"
    bindsym w [con_mark="w"] focus, mode "default"
    bindsym x [con_mark="x"] focus, mode "default"
    bindsym y [con_mark="y"] focus, mode "default"
    bindsym z [con_mark="z"] focus, mode "default"

    bindsym Shift+a move window to mark a, mode "default"
    bindsym Shift+b move window to mark b, mode "default"
    bindsym Shift+c move window to mark c, mode "default"
    bindsym Shift+d move window to mark d, mode "default"
    bindsym Shift+e move window to mark e, mode "default"
    bindsym Shift+f move window to mark f, mode "default"
    bindsym Shift+g move window to mark g, mode "default"
    bindsym Shift+h move window to mark h, mode "default"
    bindsym Shift+i move window to mark i, mode "default"
    bindsym Shift+j move window to mark j, mode "default"
    bindsym Shift+k move window to mark k, mode "default"
    bindsym Shift+l move window to mark l, mode "default"
    bindsym Shift+m move window to mark m, mode "default"
    bindsym Shift+n move window to mark n, mode "default"
    bindsym Shift+o move window to mark o, mode "default"
    bindsym Shift+p move window to mark p, mode "default"
    bindsym Shift+q move window to mark q, mode "default"
    bindsym Shift+r move window to mark r, mode "default"
    bindsym Shift+s move window to mark s, mode "default"
    bindsym Shift+t move window to mark t, mode "default"
    bindsym Shift+u move window to mark u, mode "default"
    bindsym Shift+v move window to mark v, mode "default"
    bindsym Shift+w move window to mark w, mode "default"
    bindsym Shift+x move window to mark x, mode "default"
    bindsym Shift+y move window to mark y, mode "default"
    bindsym Shift+z move window to mark z, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $mod+y mode $mode_goto_mark

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right
bindsym $mod+Ctrl+c move position center

# center cursor in focused window
bindsym $mod+z exec --no-startup-id $centerscript

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation
bindsym $mod+Ctrl+l split h
bindsym $mod+Ctrl+h split h

# split in vertical orientation
bindsym $mod+Ctrl+j split v
bindsym $mod+Ctrl+k split v


# maybe remap to Mod1+{hjklHJKL}
set $mode_entire "entire split: (l/h) horizontal, (j/k) vertical, caps -> terminal"
mode $mode_entire {
    bindsym j exec --no-startup-id $entiresplitscript vertical, mode "default"
    bindsym k exec --no-startup-id $entiresplitscript vertical, mode "default"
    bindsym l exec --no-startup-id $entiresplitscript horizontal, mode "default"
    bindsym h exec --no-startup-id $entiresplitscript horizontal, mode "default"

    bindsym Shift+J exec --no-startup-id $entiresplitscript vertical i3-sensible-terminal, mode "default"
    bindsym Shift+K exec --no-startup-id $entiresplitscript vertical i3-sensible-terminal, mode "default"
    bindsym Shift+L exec --no-startup-id $entiresplitscript horizontal i3-sensible-terminal, mode "default"
    bindsym Shift+H exec --no-startup-id $entiresplitscript horizontal i3-sensible-terminal, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $mod+e mode $mode_entire

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen
bindsym $mod+Shift+f fullscreen toggle global

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+t layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# toggle sticky
bindsym $mod+Ctrl+s sticky toggle

# toggle bar mode
bindsym $mod+Shift+b bar mode toggle

# change focus between tiling / floating windows
bindsym $mod+ctrl+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
bindsym $mod+Shift+a focus child

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10
bindsym $mod+d exec --no-startup-id $workspacescript
bindsym $mod+Shift+d exec --no-startup-id $workspacescript move
bindsym $mod+c exec --no-startup-id $newworkspacescript
bindsym $mod+Shift+c exec --no-startup-id $newworkspacescript move

# rename workspace
bindsym $mod+Mod1+r exec --no-startup-id $renameworkspacescript

# switch to next/previous workspace
bindsym $mod+n workspace next_on_output
bindsym $mod+Shift+n move workspace next_on_output
bindsym $mod+p workspace prev_on_output
bindsym $mod+Shift+p move workspace prev_on_output
bindsym $mod+m workspace next
bindsym $mod+Shift+m workspace prev
bindsym $mod+$mod1+m move workspace next # does not work when I use "Mod1" instead of "$mod1"
bindsym $mod+Shift+$mod1+m move workspace prev

# switch to last workspace
bindsym $mod+Tab workspace back_and_forth

# move workspace (Mod1 is alt)
bindsym $mod+Mod1+l move workspace to output right
bindsym $mod+Mod1+h move workspace to output left

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10
bindsym $mod+Mod1+n  move container to workspace next_on_output
bindsym $mod+Mod1+Shift+n move container to workspace prev_on_output
bindsym $mod+Mod1+p move container to workspace prev_on_output
bindsym $mod+Mod1+m move container to workspace next
bindsym $mod+Mod1+Shift+m move container to workspace prev
bindsym $mod+Mod1+Shift+p move container to workspace prev

# reload the configuration file
bindsym $mod+Ctrl+r reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
#bindsym $mod+Shift+e exec --no-startup-id "i3-nagbar -t warning -m 'You pressed the exit shortcut.' -b 'Exit i3' 'i3-msg exit' -b 'Suspend' '/bin/bash $exitscript suspend' -b 'Shutdown' '/bin/bash $exitscript shutdown' -b 'Reboot' '/bin/bash $exitscript reboot'"
#lock screen (Mod1 ist Alt)
bindsym Ctrl+Mod1+l exec "$exitscript lock && xset dpms force off"

# choose a different random wallpaper
bindsym $mod+Shift+w exec --no-startup-id $wallpaperscript

# scratchpad
bindsym $mod+Shift+i move scratchpad
#bindsym $mod+i scratchpad show
bindsym $mod+i exec --no-startup-id $scratchscript
bindsym $mod+ctrl+i [instance="^(?!$scratchclass)"] scratchpad show
bindsym $mod+u scratchpad show
bindsym $mod+Shift+u [floating workspace="__focused__"] move scratchpad

# resize window (you can also use the mouse for that)
mode "resize" {
    bindsym ctrl+h resize shrink width  1 px
    bindsym ctrl+j resize grow   height 1 px
    bindsym ctrl+k resize shrink height 1 px
    # grow width not working for some reason
    bindsym ctrl+l resize grow right    1 px 

    bindsym h resize shrink width  20 px
    bindsym j resize grow   height 20 px
    bindsym k resize shrink height 20 px
    bindsym l resize grow   width  20 px

    bindsym shift+h resize shrink width  80 px
    bindsym shift+j resize grow   height 80 px
    bindsym shift+k resize shrink height 80 px
    bindsym shift+l resize grow   width  80 px

    bindsym Mod1+h resize shrink right  50 px
    bindsym Mod1+j resize shrink up     50 px
    bindsym Mod1+k resize shrink down   50 px
    bindsym Mod1+l resize shrink left 50 px

    bindsym ctrl+mod1+h resize grow left  50 px
    bindsym ctrl+mod1+j resize grow down  50 px
    bindsym ctrl+mod1+k resize grow up    50 px
    bindsym ctrl+mod1+l resize grow right 50 px

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"
bindsym $mod+Ctrl+b border toggle

set $mode_system "system: (l) lock, (e) logout, (s) suspend, (r) reboot, (shift+s) shutdown, (ctrl+s) hybrid sleep"
mode $mode_system {
    bindsym l exec --no-startup-id       $exitscript lock, mode "default"
    bindsym e exec --no-startup-id       $exitscript logout, mode "default"
    bindsym s exec --no-startup-id       $exitscript suspend, mode "default"
    bindsym r exec --no-startup-id       $exitscript reboot, mode "default"
    bindsym Shift+s exec --no-startup-id $exitscript shutdown, mode "default"
    bindsym Ctrl+s exec --no-startup-id  $exitscript hybrid_sleep, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Pause mode $mode_system

set $mode_command "command: (t)oggle default sink, (m)ove inputs to default sink, (p)ause dunst, (r)esume dunst, (u) volume++, (d) volume--, (U/D) force volume up/down, (T)oggle mouse"
mode $mode_command {
    bindsym t exec --no-startup-id $pulsescript toggle, mode "default"
    bindsym m exec --no-startup-id $pulsescript move, mode "default"
    bindsym p exec --no-startup-id killall -SIGUSR1 dunst, mode "default"
    bindsym r exec --no-startup-id killall -SIGUSR2 dunst, mode "default"
    # the following to commands do NOT switch back to default mode
    bindsym u exec --no-startup-id $pulsescript up 1
    bindsym d exec --no-startup-id $pulsescript down 1
    bindsym Shift+u exec --no-startup-id $pulsescript force_up
    bindsym Shift+d exec --no-startup-id $pulsescript force_down
    bindsym Shift+t exec --no-startup-id $mousescript toggle, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+x mode $mode_command

# colors

set $base00 #101010
set $base01 #252525
set $base02 #464646
set $base03 #525252
set $base04 #ababab
set $base05 #b9b9b9
set $base06 #e3e3e3
set $base07 #f7f7f7
set $base08 #7c7c7c
set $base09 #999999
set $base0A #a0a0a0
set $base0B #8e8e8e
set $base0C #868686
set $base0D #686868
set $base0E #747474
set $base0F #5e5e5e

client.focused $base0E $base0E $base00 $base01
client.focused_inactive $base00 $base00 $base04 $base01
client.unfocused $base01 $base01 $base04 $base01
client.urgent $base03 $base03 $base07 $base08

bar {
   font pango:Inconsolata 12
   status_command i3status --config ~/.i3/i3status
   position bottom
   tray_output primary
   colors {
        separator $base03
        background $base01
        statusline $base05
        focused_workspace $base0C $base0D $base00
        active_workspace $base02 $base02 $base07
        inactive_workspace $base01 $base01 $base03
        urgent_workspace $base08 $base08 $base07
    }
}

#rules
for_window [instance="$scratchclass"] move scratchpad, scratchpad show
for_window [instance="$floatingclass"] floating enable
for_window [class="$scratchclass"] move scratchpad, scratchpad show
for_window [class="$floatingclass"] floating enable
assign [class="mpv"] mpv
for_window [class="mpv"] workspace mpv

#enable multimedia keys
bindsym XF86AudioRaiseVolume exec --no-startup-id $pulsescript up
bindsym XF86AudioLowerVolume exec --no-startup-id $pulsescript down
bindsym Shift+XF86AudioRaiseVolume exec --no-startup-id $pulsescript force_up 10
bindsym Shift+XF86AudioLowerVolume exec --no-startup-id $pulsescript force_down 10
bindsym ctrl+XF86AudioRaiseVolume exec --no-startup-id $pulsescript up 1
bindsym ctrl+XF86AudioLowerVolume exec --no-startup-id $pulsescript down 1
bindsym XF86AudioMute exec --no-startup-id $pulsescript mute
#does not really work...
#bindsym XF86AudioPlay exec playerctl play
#bindsym XF86AudioPause exec playerctl pause
#bindsym XF86AudioNext exec playerctl next
#bindsym XF86AudioPrev exec playerctl previous

exec --no-startup-id $initscript
# vi: ft=conf
